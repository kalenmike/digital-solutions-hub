import{d as Ie,aq as Se,o as b,b as M,w as Q,J as z,q as ue,n as u,P as fe,a8 as ye,N as pe,a5 as ie,b8 as be,U as K,b6 as he,b9 as xe,A as qe,a as de,I as m,c as C,f as Ee,h as H,t as J,v as V,B as F,O as W,ab as j,ba as Be,bb as Fe,bc as ke,bd as Ne,be as $e,bf as Ae,aC as ce,s as ge,a9 as je,bg as Ve,$ as we,bh as me,bi as ve,a4 as Oe,z as oe,bj as re,aJ as Ce,aa as Me,bk as De,bl as Te,bm as Re}from"./DMgI4xW7.js";var Pe=Ie({__name:"Label",props:{for:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"label"}},setup(r){const i=r;return Se(),(l,a)=>(b(),M(u(fe),ue(i,{onMousedown:a[0]||(a[0]=n=>{!n.defaultPrevented&&n.detail>1&&n.preventDefault()})}),{default:Q(()=>[z(l.$slots,"default")]),_:3},16))}}),Ke=Pe;const We={slots:{root:"",wrapper:"",labelWrapper:"flex content-center items-center justify-between gap-1",label:"block font-medium text-default",container:"relative",description:"text-muted",error:"mt-2 text-error",hint:"text-muted",help:"mt-2 text-muted"},variants:{size:{xs:{root:"text-xs"},sm:{root:"text-xs"},md:{root:"text-sm"},lg:{root:"text-sm"},xl:{root:"text-base"}},required:{true:{label:"after:content-['*'] after:ms-0.5 after:text-error"}},orientation:{vertical:{container:"mt-1"},horizontal:{root:"flex justify-between place-items-baseline gap-2"}}},defaultVariants:{size:"md",orientation:"vertical"}},Le=["id"],Ue=["id"],He=["id"],Je=["id"],sa={__name:"UFormField",props:{as:{type:null,required:!1},name:{type:String,required:!1},errorPattern:{type:null,required:!1},label:{type:String,required:!1},description:{type:String,required:!1},help:{type:String,required:!1},error:{type:[Boolean,String],required:!1,default:void 0},hint:{type:String,required:!1},size:{type:null,required:!1},required:{type:Boolean,required:!1},eagerValidation:{type:Boolean,required:!1},validateOnInputDelay:{type:Number,required:!1},orientation:{type:null,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},setup(r){const i=r,l=ye(),a=pe(),n=F(()=>W({extend:W(We),...a.ui?.formField||{}})({size:i.size,required:i.required,orientation:i.orientation})),h=ie(be,null),f=F(()=>i.error||h?.value?.find(g=>g.name===i.name||i.errorPattern&&g.name?.match(i.errorPattern))?.message),c=K(he()),x=c.value,I=ie(xe,void 0);return qe(c,()=>{I&&i.name&&(I.value[i.name]={id:c.value,pattern:i.errorPattern})},{immediate:!0}),j(Be,c),j(Fe,F(()=>({error:f.value,name:i.name,size:i.size,eagerValidation:i.eagerValidation,validateOnInputDelay:i.validateOnInputDelay,errorPattern:i.errorPattern,hint:i.hint,description:i.description,help:i.help,ariaId:x}))),(g,k)=>(b(),M(u(fe),{as:r.as,"data-orientation":r.orientation,"data-slot":"root",class:m(n.value.root({class:[i.ui?.root,i.class]}))},{default:Q(()=>[de("div",{"data-slot":"wrapper",class:m(n.value.wrapper({class:i.ui?.wrapper}))},[r.label||l.label?(b(),C("div",{key:0,"data-slot":"labelWrapper",class:m(n.value.labelWrapper({class:i.ui?.labelWrapper}))},[Ee(u(Ke),{for:c.value,"data-slot":"label",class:m(n.value.label({class:i.ui?.label}))},{default:Q(()=>[z(g.$slots,"label",{label:r.label},()=>[H(J(r.label),1)])]),_:3},8,["for","class"]),r.hint||l.hint?(b(),C("span",{key:0,id:`${u(x)}-hint`,"data-slot":"hint",class:m(n.value.hint({class:i.ui?.hint}))},[z(g.$slots,"hint",{hint:r.hint},()=>[H(J(r.hint),1)])],10,Le)):V("",!0)],2)):V("",!0),r.description||l.description?(b(),C("p",{key:1,id:`${u(x)}-description`,"data-slot":"description",class:m(n.value.description({class:i.ui?.description}))},[z(g.$slots,"description",{description:r.description},()=>[H(J(r.description),1)])],10,Ue)):V("",!0)],2),de("div",{class:m([(r.label||!!l.label||r.description||!!l.description)&&n.value.container({class:i.ui?.container})])},[z(g.$slots,"default",{error:f.value}),i.error!==!1&&(typeof f.value=="string"&&f.value||l.error)?(b(),C("div",{key:0,id:`${u(x)}-error`,"data-slot":"error",class:m(n.value.error({class:i.ui?.error}))},[z(g.$slots,"error",{error:f.value},()=>[H(J(f.value),1)])],10,He)):r.help||l.help?(b(),C("div",{key:1,id:`${u(x)}-help`,"data-slot":"help",class:m(n.value.help({class:i.ui?.help}))},[z(g.$slots,"help",{help:r.help},()=>[H(J(r.help),1)])],10,Je)):V("",!0)],2)]),_:3},8,["as","data-orientation","class"]))}},Ge={slots:{root:"relative inline-flex items-center",base:["w-full rounded-md border-0 appearance-none placeholder:text-dimmed focus:outline-none disabled:cursor-not-allowed disabled:opacity-75","transition-colors"],leading:"absolute start-0 flex items-start",leadingIcon:"shrink-0 text-dimmed",leadingAvatar:"shrink-0",leadingAvatarSize:"",trailing:"absolute end-0 flex items-start",trailingIcon:"shrink-0 text-dimmed"},variants:{fieldGroup:{horizontal:{root:"group has-focus-visible:z-[1]",base:"group-not-only:group-first:rounded-e-none group-not-only:group-last:rounded-s-none group-not-last:group-not-first:rounded-none"},vertical:{root:"group has-focus-visible:z-[1]",base:"group-not-only:group-first:rounded-b-none group-not-only:group-last:rounded-t-none group-not-last:group-not-first:rounded-none"}},size:{xs:{base:"px-2 py-1 text-xs gap-1",leading:"ps-2 inset-y-1",trailing:"pe-2 inset-y-1",leadingIcon:"size-4",leadingAvatarSize:"3xs",trailingIcon:"size-4"},sm:{base:"px-2.5 py-1.5 text-xs gap-1.5",leading:"ps-2.5 inset-y-1.5",trailing:"pe-2.5 inset-y-1.5",leadingIcon:"size-4",leadingAvatarSize:"3xs",trailingIcon:"size-4"},md:{base:"px-2.5 py-1.5 text-sm gap-1.5",leading:"ps-2.5 inset-y-1.5",trailing:"pe-2.5 inset-y-1.5",leadingIcon:"size-5",leadingAvatarSize:"2xs",trailingIcon:"size-5"},lg:{base:"px-3 py-2 text-sm gap-2",leading:"ps-3 inset-y-2",trailing:"pe-3 inset-y-2",leadingIcon:"size-5",leadingAvatarSize:"2xs",trailingIcon:"size-5"},xl:{base:"px-3 py-2 text-base gap-2",leading:"ps-3 inset-y-2",trailing:"pe-3 inset-y-2",leadingIcon:"size-6",leadingAvatarSize:"xs",trailingIcon:"size-6"}},variant:{outline:"text-highlighted bg-default ring ring-inset ring-accented",soft:"text-highlighted bg-elevated/50 hover:bg-elevated focus:bg-elevated disabled:bg-elevated/50",subtle:"text-highlighted bg-elevated ring ring-inset ring-accented",ghost:"text-highlighted bg-transparent hover:bg-elevated focus:bg-elevated disabled:bg-transparent dark:disabled:bg-transparent",none:"text-highlighted bg-transparent"},color:{primary:"",secondary:"",success:"",info:"",warning:"",error:"",neutral:""},leading:{true:""},trailing:{true:""},loading:{true:""},highlight:{true:""},type:{file:"file:me-1.5 file:font-medium file:text-muted file:outline-none"},autoresize:{true:{base:"resize-none"}}},compoundVariants:[{color:"primary",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary"},{color:"secondary",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-secondary"},{color:"success",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-success"},{color:"info",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-info"},{color:"warning",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-warning"},{color:"error",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-error"},{color:"primary",highlight:!0,class:"ring ring-inset ring-primary"},{color:"secondary",highlight:!0,class:"ring ring-inset ring-secondary"},{color:"success",highlight:!0,class:"ring ring-inset ring-success"},{color:"info",highlight:!0,class:"ring ring-inset ring-info"},{color:"warning",highlight:!0,class:"ring ring-inset ring-warning"},{color:"error",highlight:!0,class:"ring ring-inset ring-error"},{color:"neutral",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-inverted"},{color:"neutral",highlight:!0,class:"ring ring-inset ring-inverted"},{leading:!0,size:"xs",class:"ps-7"},{leading:!0,size:"sm",class:"ps-8"},{leading:!0,size:"md",class:"ps-9"},{leading:!0,size:"lg",class:"ps-10"},{leading:!0,size:"xl",class:"ps-11"},{trailing:!0,size:"xs",class:"pe-7"},{trailing:!0,size:"sm",class:"pe-8"},{trailing:!0,size:"md",class:"pe-9"},{trailing:!0,size:"lg",class:"pe-10"},{trailing:!0,size:"xl",class:"pe-11"},{loading:!0,leading:!0,class:{leadingIcon:"animate-spin"}},{loading:!0,leading:!1,trailing:!0,class:{trailingIcon:"animate-spin"}}],defaultVariants:{size:"md",color:"primary",variant:"outline"}},Qe=["id","value","name","rows","placeholder","disabled","required"],na=Object.assign({inheritAttrs:!1},{__name:"UTextarea",props:{as:{type:null,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},placeholder:{type:String,required:!1},color:{type:null,required:!1},variant:{type:null,required:!1},size:{type:null,required:!1},required:{type:Boolean,required:!1},autofocus:{type:Boolean,required:!1},autofocusDelay:{type:Number,required:!1,default:0},autoresize:{type:Boolean,required:!1},autoresizeDelay:{type:Number,required:!1,default:0},disabled:{type:Boolean,required:!1},rows:{type:Number,required:!1,default:3},maxrows:{type:Number,required:!1,default:0},highlight:{type:Boolean,required:!1},modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},modelModifiers:{type:Object,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},icon:{type:null,required:!1},avatar:{type:Object,required:!1},leading:{type:Boolean,required:!1},leadingIcon:{type:null,required:!1},trailing:{type:Boolean,required:!1},trailingIcon:{type:null,required:!1},loading:{type:Boolean,required:!1},loadingIcon:{type:null,required:!1}},emits:["update:modelValue","blur","change"],setup(r,{expose:i,emit:l}){const a=r,n=l,h=ye(),f=ke(a,"modelValue",n,{defaultValue:a.defaultValue}),c=pe(),{emitFormFocus:x,emitFormBlur:I,emitFormInput:g,emitFormChange:k,size:O,color:p,id:D,name:T,highlight:X,disabled:L,ariaAttrs:Y}=Ne(a,{deferInputValidation:!0}),{isLeading:N,isTrailing:Z,leadingIconName:$,trailingIconName:S}=$e(a),v=F(()=>W({extend:W(Ge),...c.ui?.textarea||{}})({color:p.value,variant:a.variant,size:O?.value,loading:a.loading,highlight:X.value,autoresize:a.autoresize,leading:N.value||!!a.avatar||!!h.leading,trailing:Z.value||!!h.trailing})),y=Ae("textareaRef");function _(o){a.modelModifiers?.trim&&(o=o?.trim()??null),a.modelModifiers?.number&&(o=Ve(o)),a.modelModifiers?.nullable&&(o||=null),a.modelModifiers?.optional&&(o||=void 0),f.value=o,g()}function se(o){R(),a.modelModifiers?.lazy||_(o.target.value)}function ne(o){const q=o.target.value;a.modelModifiers?.lazy&&_(q),a.modelModifiers?.trim&&(o.target.value=q.trim()),k(),n("change",o)}function le(o){I(),n("blur",o)}function ee(){a.autofocus&&y.value?.focus()}function R(){if(a.autoresize&&y.value){y.value.rows=a.rows;const o=y.value.style.overflow;y.value.style.overflow="hidden";const q=window.getComputedStyle(y.value),U=Number.parseInt(q.paddingTop),ae=Number.parseInt(q.paddingBottom),te=U+ae,e=Number.parseInt(q.lineHeight),{scrollHeight:t}=y.value,s=(t-te)/e;s>a.rows&&(y.value.rows=a.maxrows?Math.min(s,a.maxrows):s),y.value.style.overflow=o}}return qe(f,()=>{we(R)}),ce(()=>{setTimeout(()=>{ee()},a.autofocusDelay),setTimeout(()=>{R()},a.autoresizeDelay)}),i({textareaRef:y}),(o,q)=>(b(),M(u(fe),{as:r.as,"data-slot":"root",class:m(v.value.root({class:[a.ui?.root,a.class]}))},{default:Q(()=>[de("textarea",ue({id:u(D),ref_key:"textareaRef",ref:y,value:u(f),name:u(T),rows:r.rows,placeholder:r.placeholder,"data-slot":"base",class:v.value.base({class:a.ui?.base}),disabled:u(L),required:r.required},{...o.$attrs,...u(Y)},{onInput:se,onBlur:le,onChange:ne,onFocus:q[0]||(q[0]=(...U)=>u(x)&&u(x)(...U))}),null,16,Qe),z(o.$slots,"default",{ui:v.value}),u(N)||r.avatar||h.leading?(b(),C("span",{key:0,"data-slot":"leading",class:m(v.value.leading({class:a.ui?.leading}))},[z(o.$slots,"leading",{ui:v.value},()=>[u(N)&&u($)?(b(),M(ge,{key:0,name:u($),"data-slot":"leadingIcon",class:m(v.value.leadingIcon({class:a.ui?.leadingIcon}))},null,8,["name","class"])):r.avatar?(b(),M(je,ue({key:1,size:a.ui?.leadingAvatarSize||v.value.leadingAvatarSize()},r.avatar,{"data-slot":"leadingAvatar",class:v.value.leadingAvatar({class:a.ui?.leadingAvatar})}),null,16,["size","class"])):V("",!0)])],2)):V("",!0),u(Z)||h.trailing?(b(),C("span",{key:1,"data-slot":"trailing",class:m(v.value.trailing({class:a.ui?.trailing}))},[z(o.$slots,"trailing",{ui:v.value},()=>[u(S)?(b(),M(ge,{key:0,name:u(S),"data-slot":"trailingIcon",class:m(v.value.trailingIcon({class:a.ui?.trailingIcon}))},null,8,["name","class"])):V("",!0)])],2)):V("",!0)]),_:3},8,["as","class"]))}});function Xe(r){return"schema"in r&&typeof r.coercer=="function"&&typeof r.validator=="function"&&typeof r.refiner=="function"}function Ye(r){return"~standard"in r}async function Ze(r,i){const l=await i["~standard"].validate(r);return l.issues?{errors:l.issues?.map(a=>({name:a.path?.map(n=>typeof n=="object"?n.key:n).join(".")||"",message:a.message}))||[],result:null}:{errors:null,result:l.value}}async function _e(r,i){const[l,a]=i.validate(r);return l?{errors:l.failures().map(h=>({message:h.message,name:h.path.join(".")})),result:null}:{errors:null,result:a}}function ea(r,i){if(Ye(i))return Ze(r,i);if(Xe(i))return _e(r,i);throw new Error("Form validation failed: Unsupported form schema")}function aa(r,i){return i?i.split(".").reduce((a,n)=>a?.[n],r):r}function ta(r,i,l){if(!i)return Object.assign(r,l);if(!r)return r;const a=i.split(".");let n=r;for(let f=0;f<a.length-1;f++){const c=a[f];(n[c]===void 0||n[c]===null)&&(f+1<a.length&&!Number.isNaN(Number(a[f+1]))?n[c]=[]:n[c]={}),n=n[c]}const h=a[a.length-1];return n[h]=l,r}class G extends Error{formId;errors;constructor(i,l){super("Form validation exception"),this.formId=i,this.errors=l,Object.setPrototypeOf(this,G.prototype)}}const ra={base:""},la={__name:"UForm",props:{id:{type:[String,Number],required:!1},schema:{type:null,required:!1},state:{type:null,required:!1},validate:{type:Function,required:!1},validateOn:{type:Array,required:!1,default(){return["input","blur","change"]}},disabled:{type:Boolean,required:!1},name:{type:null,required:!1},validateOnInputDelay:{type:Number,required:!1,default:300},transform:{type:null,required:!1,default:()=>!0},nested:{type:Boolean,required:!1},loadingAuto:{type:Boolean,required:!1,default:!0},class:{type:null,required:!1},onSubmit:{type:Function,required:!1}},emits:["submit","error"],setup(r,{expose:i,emit:l}){const a=r,n=l,h=pe(),f=F(()=>W({extend:W(ra),...h.ui?.form||{}})),c=a.id??he(),x=De(`form-${c}`),I=a.nested===!0&&ie(me,void 0),g=a.nested===!0?ie(ve,void 0):void 0,k=F(()=>g?.value?a.name?aa(g.value,a.name):g.value:a.state);j(me,x),j(ve,k);const O=K(new Map);ce(async()=>{I&&(await we(),I.emit({type:"attach",validate:$,formId:c,name:a.name,api:te}))}),Oe(()=>{x.reset(),I&&I.emit({type:"detach",formId:c})}),ce(async()=>{x.on(async e=>{e.type==="attach"?O.value.set(e.formId,{validate:e.validate,name:e.name,api:e.api}):e.type==="detach"?O.value.delete(e.formId):a.validateOn?.includes(e.type)&&!S.value&&(e.type!=="input"?await $({name:e.name,silent:!0,nested:!1}):(e.eager||L.has(e.name))&&await $({name:e.name,silent:!0,nested:!1})),e.type==="blur"&&L.add(e.name),(e.type==="change"||e.type==="input"||e.type==="blur"||e.type==="focus")&&X.add(e.name),(e.type==="change"||e.type==="input")&&T.add(e.name)})});const p=K([]);j(be,p);const D=K({});j(xe,D);const T=oe(new Set),X=oe(new Set),L=oe(new Set);function Y(e){return e.map(t=>({...t,id:t?.name?D.value[t.name]?.id:void 0}))}const N=K(null);async function Z(){let e=a.validate?await a.validate(k.value)??[]:[];if(a.schema){const{errors:t,result:s}=await ea(k.value,a.schema);t?e=e.concat(t):N.value=s}return Y(e)}async function $(e={silent:!1,nested:!1,transform:!1}){const t=e.name&&!Array.isArray(e.name)?[e.name]:e.name;let s=[],d=[];if(!t&&e.nested){const A=Array.from(O.value.values()).map(B=>_(B,e)),E=await Promise.all(A);d=E.filter(B=>B.error).flatMap(B=>B.error.errors.map(ze=>se(ze,B.name))),s=E.filter(B=>B.output!==void 0)}const P=[...await Z(),...d];if(t?p.value=q(P,t):p.value=P,p.value?.length){if(e.silent)return!1;throw new G(c,p.value)}return e.transform?(s.forEach(A=>{A.name?ta(N.value,A.name,A.output):Object.assign(N.value,A.output)}),N.value??k.value):k.value}const S=K(!1);j(Te,re(S));async function v(e){S.value=a.loadingAuto&&!0;const t=e;try{t.data=await $({nested:!0,transform:a.transform}),await a.onSubmit?.(t),T.clear()}catch(s){if(!(s instanceof G))throw s;const d={...t,errors:s.errors};n("error",d)}finally{S.value=!1}}const y=F(()=>a.disabled||S.value);j(Re,F(()=>({disabled:y.value,validateOnInputDelay:a.validateOnInputDelay})));async function _(e,t){try{const s=await e.validate({...t,silent:!1});return{name:e.name,output:s}}catch(s){if(!(s instanceof G))throw s;return{name:e.name,error:s}}}function se(e,t){return!t||!e.name?e:{...e,name:t+"."+e.name}}function ne(e,t){const s=t+".",d=e?.name?.startsWith(s)?e.name.substring(s.length):e.name;return{...e,name:d}}function le(e,t){return t?e.filter(s=>s?.name?.startsWith(t+".")).map(s=>ne(s,t)):e}function ee(e){return e.api.getErrors().map(t=>e.name?{...t,name:e.name+"."+t.name}:t)}function R(e,t){return!e||!t?!0:e instanceof RegExp?e.test(t):t===e||typeof e=="string"&&e.startsWith(t+".")}function o(e,t){if(!e||e instanceof RegExp)return e;if(t!==e)return typeof e=="string"&&e.startsWith(t+".")?e.substring(t.length+1):e}function q(e,t){const s=new Set(t),d=t.map(E=>D.value?.[E]?.pattern).filter(Boolean),w=E=>E.name?s.has(E.name)?!0:d.some(B=>B.test(E.name)):!1,P=p.value.filter(E=>!w(E)),A=e.filter(w);return[...P,...A]}function U(e,t){return e.filter(s=>t instanceof RegExp?!(s.name&&t.test(s.name)):!s.name||s.name!==t)}function ae(e){return!e.name||!!D.value[e.name]}const te={validate:$,errors:p,setErrors(e,t){const s=Y(e.filter(ae)),d=[];for(const w of O.value.values())if(R(t,w.name)){const P=le(e,w.name);w.api.setErrors(P,o(t,w.name||"")),d.push(...ee(w))}if(t){const w=U(p.value,t);p.value=[...w,...s,...d]}else p.value=[...s,...d]},async submit(){await v(new Event("submit"))},getErrors(e){return e?p.value.filter(t=>e instanceof RegExp?t.name&&e.test(t.name):t.name===e):p.value},clear(e){const t=e?p.value.filter(d=>ae(d)&&(e instanceof RegExp?!(d.name&&e.test(d.name)):d.name!==e)):[],s=[];for(const d of O.value.values())R(e,d.name)&&d.api.clear(),s.push(...ee(d));p.value=[...t,...s]},disabled:y,loading:S,dirty:F(()=>!!T.size),dirtyFields:re(T),blurredFields:re(L),touchedFields:re(X)};return i(te),(e,t)=>(b(),M(Me(u(I)?"div":"form"),{id:u(c),class:m(f.value({class:a.class})),onSubmit:Ce(v,["prevent"])},{default:Q(()=>[z(e.$slots,"default",{errors:p.value,loading:S.value})]),_:3},40,["id","class"]))}};export{la as _,sa as a,na as b};
